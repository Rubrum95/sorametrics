<!DOCTYPE html>
<html lang="es">

<head>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WD62PK78');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <title>SoraMetrics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <meta name="theme-color" content="#D0021B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/9.1.1/bignumber.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.0.1/dist/lightweight-charts.standalone.production.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        /* THEME VARIABLES */
        :root {
            --bg-body: #F3F4F6;
            --bg-card: #FFFFFF;
            --text-primary: #111827;
            --text-secondary: #6B7280;
            --border-color: #E5E7EB;
            --primary-color: #D0021B;
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --bg-hover: #F9FAFB;
            --card-radius: 16px;
        }

        [data-theme="dark"] {
            --bg-body: #0f0f0f;
            --bg-card: #1a1a1a;
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --border-color: #333333;
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            --shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.7);
            --bg-hover: #262626;
        }

        /* Dark Mode: Bottom Navigation Bar */
        [data-theme="dark"] .tabs.main-tabs,
        [data-theme="dark"] #dynamicTabsContainer {
            background: rgba(15, 15, 15, 0.98) !important;
            border-top: 1px solid #333 !important;
        }

        [data-theme="dark"] .tabs.main-tabs .tab-btn,
        [data-theme="dark"] #dynamicTabsContainer .tab-btn {
            color: #9ca3af;
        }

        [data-theme="dark"] .tabs.main-tabs .tab-btn.active,
        [data-theme="dark"] #dynamicTabsContainer .tab-btn.active {
            color: white !important;
            background: #D0021B !important;
        }

        /* Spacing between timeframe selector and stats cards */
        .header-stats {
            margin-top: 15px;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            margin: 0;
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.3s, color 0.3s;
        }

        /* CONTAINER */
        * {
            box-sizing: border-box;
        }

        /* CONTAINER */
        .container {
            width: 95%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px 40px;
        }

        /* HEADER */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
            /* For menu positioning context if needed */
        }

        .token-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            font-size: 13px;
            color: var(--text-primary);
            transition: transform 0.2s;
        }

        .token-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        /* MENU BUTTON & SIDEBAR */
        .menu-btn {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 50%;
            /* Circle bubble */
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
            z-index: 1200;
            /* Above regular content */
        }

        .menu-btn:hover {
            transform: scale(1.05);
            background: #FAFAFA;
        }

        /* SLIDE OUT MENU */
        .side-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1400;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .side-menu-overlay.show {
            display: block;
            opacity: 1;
        }

        .side-menu {
            position: fixed;
            top: 0;
            left: -300px;
            /* Hidden: 260px width + 20px padding + extra for shadow */
            width: 260px;
            height: 100%;
            background: white;
            z-index: 1500;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease-in-out;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .side-menu.show {
            left: 0;
        }

        .menu-item {
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            color: #374151;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.2s;
        }

        .menu-item:hover {
            background: #F3F4F6;
        }

        .menu-item.active {
            background: #fee2e2;
            color: #DC2626;
        }

        /* Red tint */

        /* INTELLIGENCE DASHBOARD */
        .intel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        /* INTEL CARDS (Enhanced) */
        .intel-card {
            background: var(--bg-card);
            border-radius: var(--card-radius);
            padding: 20px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border-color);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .intel-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .intel-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* NETWORK STATS */
        .stat-big {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-sub {
            font-size: 12px;
            color: #10B981;
            font-weight: 600;
        }

        .stat-down {
            color: #EF4444;
        }

        /* PEG MONITOR */
        .peg-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 10px;
            background: var(--bg-body);
            border-radius: 10px;
        }

        .peg-val {
            font-family: monospace;
            font-weight: bold;
            color: var(--text-primary);
        }

        .peg-ok {
            color: #10B981;
        }

        .peg-warn {
            color: #F59E0B;
        }

        .peg-alert {
            color: #EF4444;
        }


        .tab-btn {
            border: none;
            background: transparent;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #6B7280;
        }

        .tab-btn.active {
            background: #D0021B !important;
            color: white !important;
        }

        .tab-btn-small {
            background: transparent;
            border: none;
            color: #6B7280;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tab-btn-small:hover {
            color: #111827;
        }

        .tab-btn-small.active {
            background: white;
            color: #D0021B;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }

        /* TABS CONTENT */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border-color);
        }

        /* TABLAS */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        th {
            text-align: left;
            color: var(--text-secondary);
            font-size: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .wallet-saved {
            color: var(--primary-color) !important;
            font-weight: 700;
            cursor: pointer;
        }

        .wallet-saved:hover {
            text-decoration: underline;
        }

        .wallet-unsaved {
            color: var(--text-primary) !important;
            font-weight: 500;
            cursor: pointer;
        }

        .wallet-unsaved:hover {
            text-decoration: underline;
        }

        td {
            padding: 16px 0;
            border-bottom: 1px solid #F3F4F6;
            vertical-align: middle;
        }

        .asset-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .asset-row img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
        }

        .wallet-tag {
            background: #F3F4F6;
            color: #4B5563;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-family: monospace;
        }

        /* BOTONES */
        .btn-primary {
            background-color: #EF4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
        }

        .btn-primary:hover {
            background-color: #DC2626;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(239, 68, 68, 0.3);
        }

        .btn-red {
            background: #D0021B;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        /* BOTONES ACTION */
        .action-group {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .btn-ghost {
            background: transparent;
            color: #6B7280;
            border: 1px solid transparent;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            display: inline-flex;
            /* Changed from flex to inline-flex to respect text-align:center of parent */
            align-items: center;
            justify-content: center;
            /* Center content */
            gap: 6px;
            transition: all 0.2s ease;
        }

        .btn-ghost:hover {
            background: #F3F4F6;
            color: #111827;
        }

        .btn-ghost svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            stroke-width: 2;
        }

        .btn-icon-only {
            padding: 6px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6B7280;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            background: transparent;
        }

        .btn-icon-only:hover {
            background: #F3F4F6;
            color: #D0021B;
        }

        .btn-icon-only svg {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            width: 600px;
            max-width: 95%;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .close-modal {
            float: right;
            font-size: 24px;
            cursor: pointer;
            color: #9CA3AF;
        }

        .search-box {
            display: flex;
            gap: 10px;
            background: transparent;
            padding: 8px 0;
            border-radius: 12px;
            margin-bottom: 20px;
            align-items: center;
        }

        /* PAGINATION BUTTONS */
        .btn-holders,
        .secondary-btn,
        .top-btn {
            background: var(--bg-body);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 6px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-holders:hover,
        .secondary-btn:hover,
        .top-btn:hover {
            background: var(--bg-card);
            border-color: var(--primary-color);
            color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .btn-holders:disabled,
        .secondary-btn:disabled,
        .top-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--bg-body);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 8px;
            outline: none;
        }

        /* MOBILE FIX: Ensure buttons are tappable and SVGs don't block taps */
        .btn-ghost {
            background: transparent;
            border: 1px solid transparent;
            cursor: pointer;
            pointer-events: auto !important;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background 0.2s;
            touch-action: manipulation;
            /* Improves touch response */
        }

        .btn-ghost:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .btn-ghost:active {
            background: rgba(0, 0, 0, 0.1);
        }

        button svg {
            pointer-events: none !important;
        }

        /* CUSTOM DROPDOWN Styles */
        .custom-select-wrapper {
            position: relative;
            user-select: none;
            width: 100px;
        }

        .custom-select-trigger {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .custom-select-trigger:hover {
            border-color: #D1D5DB;
            background: var(--bg-body);
        }

        /* Arrow */
        .custom-select-trigger::after {
            content: '';
            width: 8px;
            height: 8px;
            border: 2px solid var(--text-secondary);
            border-top: none;
            border-right: none;
            transform: rotate(-45deg);
            margin-left: 8px;
            margin-top: -2px;
        }

        /* Options Menu */
        .custom-options {
            position: absolute;
            top: 115%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: var(--shadow-hover);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 9999;
            overflow: hidden;
        }

        .custom-select-wrapper.open .custom-options {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .custom-option {
            padding: 10px 15px;
            font-size: 13px;
            color: var(--text-primary);
            cursor: pointer;
            transition: background 0.1s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .custom-option:hover {
            background: var(--bg-body);
            color: var(--text-primary);
        }

        .custom-option.selected {
            background: rgba(208, 2, 27, 0.1);
            color: #D0021B;
            font-weight: 600;
        }

        .tokens-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }



        .filter-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: 1px solid #E5E7EB;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .filter-btn:hover {
            border-color: #D0021B;
            background: #FEF2F2;
        }

        .filter-btn.active {
            background: #D0021B;
            color: white;
            border-color: #D0021B;
        }

        .filter-btn img {
            width: 20px;
            height: 20px;
            min-width: 20px;
            /* Prevent shrinking */
            border-radius: 50%;
            background: white;
            object-fit: cover;
        }

        .currency-symbol {
            color: #9CA3AF;
            font-weight: 400;
            margin-right: 1px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        .price-value {
            font-family: 'JetBrains Mono', 'Fira Code', 'Roboto Mono', monospace;
            font-variant-numeric: tabular-nums;
            letter-spacing: -0.5px;
            color: #0284C7;
            /* Sky Blue */
            font-weight: 500;
        }

        .tab-btn-small {
            background: transparent;
            border: 1px solid #E5E7EB;
            padding: 6px 14px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #6B7280;
            transition: all 0.2s;
        }

        .tab-btn-small:hover {
            border-color: #D1D5DB;
            color: #374151;
            background: #F9FAFB;
        }

        .tab-btn-small.active {
            background: #111827;
            color: white;
            border-color: #111827;
            font-weight: 600;
        }

        /* CUSTOM DROPDOWN */
        .custom-dropdown {
            position: relative;
            display: inline-block;
            width: 220px;
        }

        .dropdown-btn {
            background: white;
            border: 1px solid #E5E7EB;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: #374151;
        }

        .dropdown-btn:hover {
            border-color: #D1D5DB;
        }

        /* Language Dropdown Fix */
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--bg-card);
            min-width: 160px;
            box-shadow: var(--shadow-hover);
            z-index: 2000;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-top: 5px;
            overflow: hidden;
            right: 0;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-content a {
            color: var(--text-primary);
            padding: 10px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 14px;
            transition: background 0.1s;
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-content a:last-child {
            border-bottom: none;
        }

        .dropdown-content a:hover {
            background-color: var(--bg-hover);
            color: var(--primary-color);
        }

        .dropdown-search {
            width: 100%;
            box-sizing: border-box;
            border: none;
            border-bottom: 1px solid #E5E7EB;
            padding: 10px;
            outline: none;
            font-size: 13px;
        }

        .dropdown-list {
            max-height: 250px;
            overflow-y: auto;
        }

        .dropdown-item {
            padding: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: #374151;
        }

        .dropdown-item:hover {
            background-color: var(--bg-hover);
        }

        .wallet-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .time-btn {
            background: white;
            border: 1px solid #E5E7EB;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .time-btn.active {
            background: #D0021B;
            color: white;
            border-color: #D0021B;
        }

        /* --- MOBILE OPTIMIZATION (RESPONSIVE & TOUCH) --- */
        @media (max-width: 768px) {

            /* Layout General */
            body {
                padding: 10px;
                padding-bottom: 80px;
                overflow-x: hidden;
            }

            .container {
                padding: 0 15px;
                width: 100%;
                overflow-x: hidden;
            }

            /* Header Simplificado (Solo Logo e Idioma) */
            .header {
                flex-direction: row;
                flex-wrap: wrap;
                /* Permitir que los elementos bajen si no caben */
                justify-content: space-between;
                align-items: center;
                gap: 10px;
                /* Reducir gap */
                margin-bottom: 25px;
            }

            .header>div:last-child {
                flex-direction: row;
                /* Idioma alineado a la derecha */
                width: auto;
                align-items: center;
            }

            .logo {
                justify-content: flex-start;
                transform: scale(0.9);
            }

            /* --- BOTTOM NAVIGATION BAR (APP STYLE) --- */
            .main-tabs {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: rgba(255, 255, 255, 0.98);
                /* Transparencia estilo iOS */
                backdrop-filter: blur(10px);
                z-index: 1000;
                border-radius: 0;
                border-top: 1px solid #E5E7EB;
                box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.05);
                display: flex;
                justify-content: space-evenly;
                padding: 8px 5px;
                padding-bottom: max(8px, env(safe-area-inset-bottom));
                /* iPhone X Fix */
                margin: 0;
                overflow: visible;
            }

            .tabs::-webkit-scrollbar {
                display: none;
            }

            /* Estilo BotÃ³n App */
            .main-tabs .tab-btn {
                background: transparent !important;
                color: #9CA3AF !important;
                border: none;
                flex-direction: column;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 10px;
                font-weight: 500;
                padding: 4px;
                gap: 4px;
                width: 100%;
                opacity: 0.7;
                transition: all 0.2s;
            }

            .main-tabs .tab-btn.active {
                background: transparent !important;
                color: #D0021B !important;
                opacity: 1;
                transform: translateY(-2px);
            }

            /* ICONOS PARA BOTTOM BAR */
            #tab-balance::before {
                content: "ðŸ’¼";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-swaps::before {
                content: "âš¡";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-transfers::before {
                content: "ðŸ’¸";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-tokens::before {
                content: "ðŸª™";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-liquidity::before {
                content: "ðŸŒŠ";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-bridges::before {
                content: "ðŸŒ‰";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            #tab-section-intelligence::before {
                content: "ðŸ§ ";
                font-size: 20px;
                display: block;
                margin-bottom: 2px;
            }

            /* Ocultar texto de botones en pantallas muy pequeÃ±as si es necesario,
                pero para 320px+ cabe bien Icono + Texto pequeÃ±o */
            /* .tab-btn span { display: none; } */

            /* Tablas a Tarjetas (Card View) */
            table,
            thead,
            tbody,
            th,
            td,
            tr {
                display: block;
            }

            thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            tr {
                background: var(--bg-card);
                /* Fix Dark Mode */
                border-radius: 12px;
                padding: 15px;
                margin-bottom: 15px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                border: 1px solid var(--border-color);
                /* Fix Dark Mode */
            }

            td {
                border: none;
                position: relative;
                padding: 5px 0;
                padding-left: 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                text-align: right;
            }

            /* Fix Modal on Mobile */
            .modal-content {
                padding: 15px !important;
                width: 95% !important;
                margin: 10px auto;
                max-height: 90vh;
                box-sizing: border-box;
                /* Ensure padding doesn't expand width */
            }

            .close-modal {
                font-size: 32px;
                padding: 5px 10px;
                margin: 0;
                /* Reset negative margins */
                color: #333;
                cursor: pointer;
            }

            #chartModal .modal-content {
                padding: 5px !important;
                /* Minimal padding for close button */
                width: 100% !important;
                margin: 0 !important;
                max-width: 100% !important;
                border-radius: 0;
                height: 50vh;
                /* Use half screen or more */
                position: absolute;
                bottom: 0;
                overflow-y: hidden;
                /* Chart handles scroll */
            }

            #chartContainer {
                height: 100% !important;
                width: 100% !important;
                position: relative;
                overflow: hidden;
            }

            #chartContainer {
                height: 300px !important;
                width: 100% !important;
                position: relative;
                overflow: hidden;
                touch-action: none;
                /* Critical: Prevent background scroll */
            }

            .close-modal {
                font-size: 32px;
                /* Bigger touch target */
                padding: 10px;
                margin: -10px -10px 0 0;
                /* Adjust position */
                line-height: 1;
            }

            /* --- I18N LABELS (ETIQUETAS DINÃMICAS POR IDIOMA) --- */

            /* Estilo base de labels */
            td::before {
                color: #9CA3AF;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                white-space: nowrap;
            }

            /* Ocultar celdas innecesarias en mÃ³vil:
               - Swaps: Bloque (2), flecha (4), AcciÃ³n (7)
               - Transfers: Bloque (2), flecha (5), AcciÃ³n (7) 
            */
            #transfers td:nth-of-type(2),
            #transfers td:nth-of-type(5),
            #transfers td:nth-of-type(7),
            #swaps td:nth-of-type(2),
            #swaps td:nth-of-type(4),
            #swaps td:nth-of-type(7) {
                display: none;
            }

            /* Mobile pagination fix */
            #transfers+div,
            #swaps~div,
            .card>div[style*="justify-content:center"][style*="gap:5px"] {
                flex-wrap: wrap;
                padding: 0 10px;
            }

            .btn-holders {
                min-width: auto;
                padding: 6px 10px;
                font-size: 12px;
            }

            /* Ensure pagination container doesn't overflow */
            div[style*="justify-content:center"][style*="gap:5px"] {
                width: 100%;
                box-sizing: border-box;
            }

            /* --- TRANSFERS LABELS --- */
            /* Col 1: Hora, Col 3: De, Col 4: Cantidad, Col 6: Para */

            /* --- ESPAÃ‘OL (Default) --- */
            :lang(es) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ Hora";
            }

            :lang(es) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ De";
            }

            :lang(es) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° Cantidad";
            }

            :lang(es) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ Para";
            }

            /* --- SWAPS LABELS --- */
            /* Col 1: Hora, Col 3: Entrada, Col 5: Salida, Col 6: Cuenta */

            :lang(es) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ Hora";
            }

            :lang(es) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ Entrada";
            }

            :lang(es) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ Salida";
            }

            :lang(es) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ Cuenta";
            }

            /* --- ENGLISH --- */
            :lang(en) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ Time";
            }

            :lang(en) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ From";
            }

            :lang(en) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° Amount";
            }

            :lang(en) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ To";
            }

            :lang(en) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ Time";
            }

            :lang(en) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ In";
            }

            :lang(en) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ Out";
            }

            :lang(en) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ Account";
            }

            /* --- JAPANESE --- */
            :lang(jp) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ æ™‚é–“";
            }

            :lang(jp) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ é€ä¿¡å…ƒ";
            }

            :lang(jp) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° é‡‘é¡";
            }

            :lang(jp) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ é€ä¿¡å…ˆ";
            }

            :lang(jp) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ æ™‚é–“";
            }

            :lang(jp) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ å…¥åŠ›";
            }

            :lang(jp) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ å‡ºåŠ›";
            }

            :lang(jp) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ";
            }

            /* --- RUSSIAN --- */
            :lang(ru) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ Ð’Ñ€ÐµÐ¼Ñ";
            }

            :lang(ru) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ ÐžÑ‚";
            }

            :lang(ru) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° Ð¡ÑƒÐ¼Ð¼Ð°";
            }

            :lang(ru) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ ÐšÐ¾Ð¼Ñƒ";
            }

            :lang(ru) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ Ð’Ñ€ÐµÐ¼Ñ";
            }

            :lang(ru) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ Ð’Ñ…Ð¾Ð´";
            }

            :lang(ru) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ Ð’Ñ‹Ñ…Ð¾Ð´";
            }

            :lang(ru) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ ÐÐºÐºÐ°ÑƒÐ½Ñ‚";
            }

            /* --- HEBREW (RTL handled by dir, but labels needed) --- */
            :lang(he) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ ×–×ž×Ÿ";
            }

            :lang(he) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ ×ž××ª";
            }

            :lang(he) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° ×›×ž×•×ª";
            }

            :lang(he) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ ××œ";
            }

            :lang(he) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ ×–×ž×Ÿ";
            }

            :lang(he) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ ×§×œ×˜";
            }

            :lang(he) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ ×¤×œ×˜";
            }

            :lang(he) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ ×—×©×‘×•×Ÿ";
            }

            /* --- CHINESE --- */
            :lang(zh) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ æ—¶é—´";
            }

            :lang(zh) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ å‘é€æ–¹";
            }

            :lang(zh) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° é‡‘é¢";
            }

            :lang(zh) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ æŽ¥æ”¶æ–¹";
            }

            :lang(zh) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ æ—¶é—´";
            }

            :lang(zh) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ è¾“å…¥";
            }

            :lang(zh) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ è¾“å‡º";
            }

            :lang(zh) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ è´¦æˆ·";
            }

            /* --- URDU --- */
            :lang(ur) #transfers td:nth-of-type(1)::before {
                content: "ðŸ•’ ÙˆÙ‚Øª";
            }

            :lang(ur) #transfers td:nth-of-type(3)::before {
                content: "ðŸ“¤ Ø³Û’";
            }

            :lang(ur) #transfers td:nth-of-type(4)::before {
                content: "ðŸ’° Ø±Ù‚Ù…";
            }

            :lang(ur) #transfers td:nth-of-type(6)::before {
                content: "ðŸ“¥ Ú©Ùˆ";
            }

            :lang(ur) #swaps td:nth-of-type(1)::before {
                content: "ðŸ•’ ÙˆÙ‚Øª";
            }

            :lang(ur) #swaps td:nth-of-type(3)::before {
                content: "â¬‡ï¸ Ø§Ù† Ù¾Ù¹";
            }

            :lang(ur) #swaps td:nth-of-type(5)::before {
                content: "â¬†ï¸ Ø¢Ø¤Ù¹ Ù¾Ù¹";
            }

            :lang(ur) #swaps td:nth-of-type(6)::before {
                content: "ðŸ‘¤ Ø§Ú©Ø§Ø¤Ù†Ù¹";
            }

            .asset-row {
                justify-content: flex-end;
            }

            /* Swaps: Fix large numbers and asset row layout */
            #swaps .asset-row {
                flex-direction: column;
                align-items: flex-end !important;
                gap: 2px !important;
            }

            #swaps .asset-row div {
                font-size: 11px !important;
                max-width: 100%;
                text-align: right;
            }

            #swaps .asset-row b {
                font-size: 12px !important;
                word-break: break-word;
                display: block;
            }

            #swaps .asset-row img {
                width: 20px !important;
                height: 20px !important;
            }

            /* For very large numbers in swaps, use smaller font */
            #swaps td:nth-of-type(3),
            #swaps td:nth-of-type(5) {
                font-size: 11px !important;
            }

            /* Pagination container fix for mobile - force single row */
            .card>div[style*="gap:5px"],
            div[style*="justify-content:center"][style*="gap:5px"] {
                flex-wrap: nowrap !important;
                gap: 4px !important;
                padding: 10px 5px !important;
                justify-content: center !important;
                width: 100% !important;
                overflow-x: auto;
            }

            /* First/Last pagination buttons smaller on mobile */
            #btnTransferFirst,
            #btnTransferLast,
            #btnSwapFirst,
            #btnSwapLast,
            #btnBridgeFirst,
            #btnBridgeLast,
            #btnLiqFirst,
            #btnLiqLast {
                padding: 6px 8px !important;
                font-size: 12px !important;
                min-width: 28px !important;
            }

            /* Prev/Next buttons compact */
            #btnTransferPrev,
            #btnTransferNext,
            #btnSwapPrev,
            #btnSwapNext,
            #btnBridgePrev,
            #btnBridgeNext,
            #btnLiqPrev,
            #btnLiqNext {
                padding: 6px 8px !important;
                font-size: 12px !important;
            }

            /* Hide "Anterior/Siguiente" text on very small screens, keep arrows */
            #btnTransferPrev span,
            #btnTransferNext span,
            #btnSwapPrev span,
            #btnSwapNext span,
            #btnBridgePrev span,
            #btnBridgeNext span,
            #btnLiqPrev span,
            #btnLiqNext span {
                display: none;
            }

            /* Page indicator smaller */
            #transferPageIndicator,
            #swapPageIndicator,
            #bridgePageIndicator,
            #liquidityPageIndicator {
                font-size: 10px !important;
                white-space: nowrap;
                margin: 0 4px !important;
            }
        }

        /* --- NEW STYLES --- */
        .whale-row,
        #intel-trends>div {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .whale-row:last-child,
        #intel-trends>div:last-child {
            border-bottom: none;
        }

        .stat-big {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.2;
        }

        @media (max-width: 768px) {
            .stat-big {
                font-size: 20px;
                /* Smaller on mobile */
            }

            .whale-row,
            #intel-trends>div {
                flex-wrap: wrap;
            }

            .whale-row>div:last-child,
            #intel-trends>div>div:last-child {
                width: 100%;
                text-align: right;
                margin-top: 4px;
                font-size: 13px;
                /* Smaller font for overflowing numbers */
            }

            /* MOBILE FIX: Reduce container padding */
            .container {
                padding: 15px 15px !important;
                width: 100% !important;
            }

            /* Prevent horizontal scroll */
            body,
            html {
                overflow-x: hidden;
            }
        }

        /* PATCH: Fix missing Tokens icon on mobile */
        @media (max-width: 768px) {
            #tab-tokens::before {
                content: "ðŸ’Ž" !important;
            }
        }
    </style>
</head>

<body class="bg-gray-100 font-sans">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WD62PK78" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Side Menu Structure (Customizable Navigation) -->
    <div class="side-menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
    <div class="side-menu" id="sideMenu">
        <h2 style="margin-top:0; color:#D0021B;">Sora<span style="color:#111">Metrics</span></h2>
        <div style="font-size:12px; color:#6B7280; margin-bottom:15px;" data-i18n="menu_instruction">
            Visibles (Max 5)
        </div>

        <!-- Generic Container for Toggles (Populated by JS) -->
        <div id="sidebarSectionList" style="display:flex; flex-direction:column; gap:10px;">
            <!-- JS will inject toggle items here -->
        </div>

        <div style="margin-top:auto; font-size:12px; color:#999; text-align:center;">v2.0 - Customizable</div>
    </div>

    <div class="container">

        <!-- HEADER (Restored Original Layout) -->
        <div class="header">
            <div style="display:flex; align-items:center; gap:15px;">
                <button class="menu-btn" onclick="toggleMenu()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#374151" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>

                <!-- ORIGINAL LOGO RESTORED -->
                <div class="logo" style="display:flex; align-items:center; gap:12px;">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 226.1 226.1"
                        style="enable-background:new 0 0 226.1 226.1; width:50px; height:50px;" xml:space="preserve">
                        <style type="text/css">
                            .st0 {
                                display: none;
                                fill: #E4232D;
                            }

                            .st1 {
                                display: none;
                            }

                            .st2 {
                                display: inline;
                                fill: none;
                                stroke: #FFFFFF;
                                stroke-width: 1.438;
                            }

                            .st3 {
                                display: inline;
                                fill: none;
                                stroke: #FFFFFF;
                                stroke-width: 1.445;
                            }

                            .st4 {
                                display: inline;
                            }

                            .st5 {
                                fill: none;
                                stroke: #FFFFFF;
                                stroke-width: 1.438;
                            }

                            .st6 {
                                fill: #FFFFFF;
                                stroke: #FFFFFF;
                                stroke-width: 1.438;
                            }

                            .st7 {
                                display: none;
                                fill: var(--text-primary);
                            }

                            .st8 {
                                display: inline;
                                fill: #FF0000;
                            }

                            .st9 {
                                display: none;
                                fill: #E3242D;
                            }

                            .st10 {
                                fill: #E3242D;
                            }

                            /* Language Dropdown Fix */
                            .dropdown-content {
                                display: none;
                                position: absolute;
                                background-color: var(--bg-card);
                                min-width: 160px;
                                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
                                z-index: 2000;
                                border-radius: 8px;
                                border: 1px solid var(--border-color);
                                margin-top: 5px;
                                overflow: hidden;
                                right: 0;
                            }

                            .dropdown-content.show {
                                display: block;
                            }

                            .dropdown-content a {
                                color: #374151;
                                padding: 10px 16px;
                                text-decoration: none;
                                display: flex;
                                align-items: center;
                                justify-content: space-between;
                                font-size: 14px;
                                transition: background 0.1s;
                                border-bottom: 1px solid var(--border-color);
                            }

                            .dropdown-content a:last-child {
                                border-bottom: none;
                            }

                            .dropdown-content a:hover {
                                background-color: var(--bg-hover);
                                color: var(--text-primary);
                            }

                            /* Custom Scrollbar */
                            ::-webkit-scrollbar {
                                width: 8px;
                                height: 8px;
                            }

                            ::-webkit-scrollbar-track {
                                background: transparent;
                            }

                            ::-webkit-scrollbar-thumb {
                                background: #cbd5e1;
                                border-radius: 4px;
                            }

                            body.dark ::-webkit-scrollbar-thumb {
                                background: #4B5563;
                            }

                            ::-webkit-scrollbar-thumb:hover {
                                background: #94a3b8;
                            }

                            body.dark ::-webkit-scrollbar-thumb:hover {
                                background: #6B7280;
                            }
                        </style>
                        <g>
                            <path class="st10" d="M43.9,112.9V94.3h59.8V75.2H43.9V56.7h138.2v18.6h-59.8v19.1h59.8v18.6h-59.8l60.1,89.4
                                c26.6-20.7,43.7-53,43.7-89.3C226.1,50.6,175.5,0,113.1,0C50.6,0,0,50.6,0,113.1c0,36.3,17.1,68.6,43.7,89.3l60.1-89.4
                                C103.8,112.9,43.9,112.9,43.9,112.9z" />
                            <path class="st10"
                                d="M59.2,212.5c16,8.7,34.3,13.6,53.8,13.6c19.5,0,37.8-4.9,53.8-13.6l-53.8-80.2L59.2,212.5z" />
                        </g>
                    </svg>
                    <div style="font-size:28px; font-weight:700; line-height: 1;">
                        <span style="color:#D0021B;">Sora</span><span style="color:var(--text-primary);">Metrics</span>
                    </div>
                </div>
            </div>

            <!-- Dynamic Tabs Container (Centered) -->
            <div class="tabs main-tabs" id="dynamicTabsContainer"
                style="display:flex; justify-content:center; flex:1; gap:10px;">
                <!-- Populated by JS -->
            </div>

            <!-- Header Actions -->
            <div style="display:flex; gap:10px; align-items:center;">
                <!-- Theme Toggle -->
                <button class="btn-icon-only" onclick="toggleTheme()" title="Cambiar Tema" id="themeToggleBtn"
                    style="background:var(--bg-card); border:1px solid var(--border-color); padding:8px; border-radius:8px; color:var(--text-secondary);">
                    <!-- Sun Icon (Default) -->
                    <svg id="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <!-- Moon Icon (Hidden) -->
                    <svg id="icon-moon" style="display:none;" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
                <!-- BotÃ³n Backup -->
                <button class="btn-icon-only" onclick="openBackupModal()" title="Copia de Seguridad"
                    style="background:white; border:1px solid #E5E7EB; padding:6px; border-radius:8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z">
                        </path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                </button>

                <!-- Language (Restored Pill Style) -->
                <div class="custom-dropdown" id="langDropdown" style="width: auto;">
                    <button class="dropdown-btn" onclick="toggleLangDropdown()" id="langBtn"
                        style="background:white; border:1px solid #E5E7EB; padding:6px 12px; border-radius:8px; font-size:13px; font-weight:600; color:#374151; display:flex; align-items:center; gap:5px;">
                        <span id="currentLangFlag">ES</span>
                        <svg width="10" height="6" viewBox="0 0 10 6" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="1 1 5 5 9 1"></polyline>
                        </svg>
                    </button>
                    <div class="dropdown-content" id="langDropdownContent" style="min-width: 150px; right: 0;">
                        <a href="#" onclick="changeLanguage('es')">ES ðŸ‡ªðŸ‡¸</a>
                        <a href="#" onclick="changeLanguage('en')">EN ðŸ‡ºðŸ‡¸</a>
                        <a href="#" onclick="changeLanguage('jp')">JP ðŸ‡¯ðŸ‡µ</a>
                        <a href="#" onclick="changeLanguage('pt')">PT ðŸ‡µðŸ‡¹</a>
                        <a href="#" onclick="changeLanguage('it')">IT ðŸ‡®ðŸ‡¹</a>
                        <a href="#" onclick="changeLanguage('tr')">TR ðŸ‡¹ðŸ‡·</a>
                        <a href="#" onclick="changeLanguage('he')">HE ðŸ‡®ðŸ‡±</a>
                        <a href="#" onclick="changeLanguage('ru')">RU ðŸ‡·ðŸ‡º</a>
                        <a href="#" onclick="changeLanguage('zh')">ZH ðŸ‡¨ðŸ‡³</a>
                        <a href="#" onclick="changeLanguage('ur')">UR ðŸ‡µðŸ‡° Urdu (Ø§Ø±Ø¯Ùˆ)</a>
                    </div>
                </div>

                <!-- Add Wallet -->
                <button class="btn-primary" onclick="openAddWalletModal()" data-i18n="btn_add_wallet">+ AÃ±adir
            </div>
        </div>

        <div id="transfers" class="tab-content">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 data-i18n="tab_transfers" style="margin:0; font-size:18px;">Transfers</h3>
                    <input type="datetime-local" id="transferDateInput" onchange="loadGlobalTransfers(true)"
                        style="padding:6px; border:1px solid #E5E7EB; border-radius:8px; color:#374151; font-family:inherit; font-size:13px; max-width:180px;">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="time">Hora</th>
                            <th data-i18n="block">Bloque</th>
                            <th data-i18n="from">De</th>
                            <th data-i18n="amount">Cantidad</th>
                            <th></th>
                            <th data-i18n="to">Para</th>
                            <th data-i18n="action">AcciÃ³n</th>
                        </tr>
                    </thead>
                    <tbody id="transferTable">
                        <tr>
                            <td colspan="5" style="text-align:center; padding:20px; color:#9CA3AF;"
                                data-i18n="waiting_activity">
                                Esperando actividad...</td>
                        </tr>
                    </tbody>
                </table>
                <div style="display:flex; justify-content:center; gap:5px; margin-top:20px; align-items:center;">
                    <button id="btnTransferFirst" class="btn-holders" onclick="changeTransferPage('first')"
                        title="Inicio">â‡¤</button>
                    <button id="btnTransferPrev" class="btn-holders" onclick="changeTransferPage(-1)">â¬…
                        <span data-i18n="previous">Anterior</span></button>
                    <span id="transferPageIndicator" style="font-size:13px; color:#6B7280; margin:0 10px;"
                        data-i18n="page_x_of_y">PÃ¡gina
                        1</span>
                    <button id="btnTransferNext" class="btn-holders" onclick="changeTransferPage(1)"><span
                            data-i18n="next">Siguiente</span>
                        âž¡</button>
                    <button id="btnTransferLast" class="btn-holders" onclick="changeTransferPage('last')"
                        title="Final">â‡¥</button>
                </div>
            </div>
        </div>

        <div id="bridges" class="tab-content">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 style="margin:0; font-size:18px;" data-i18n="tab_bridges">ðŸŒ‰ Puentes</h3>
                    <input type="datetime-local" id="bridgeDateInput" onchange="loadGlobalBridges(true)"
                        style="padding:6px; border:1px solid #E5E7EB; border-radius:8px; color:#374151; font-family:inherit; font-size:13px; max-width:180px;">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="time">Hora</th>
                            <th data-i18n="block">Bloque</th>
                            <th data-i18n="network">Red</th>
                            <th>DirecciÃ³n</th>
                            <th data-i18n="from">De</th>
                            <th data-i18n="to">Para</th>
                            <th data-i18n="amount">Cantidad</th>
                            <th data-i18n="action">AcciÃ³n</th>
                        </tr>
                    </thead>
                    <tbody id="bridgeTable">
                        <tr>
                            <td colspan="6" style="text-align:center; padding:20px; color:#9CA3AF;" data-i18n="loading">
                                Cargando...</td>
                        </tr>
                    </tbody>
                </table>
                <div style="display:flex; justify-content:center; gap:5px; margin-top:20px; align-items:center;">
                    <button id="btnBridgeFirst" class="btn-holders" onclick="changeBridgePage('first')"
                        title="Inicio">â‡¤</button>
                    <button id="btnBridgePrev" class="btn-holders" onclick="changeBridgePage(-1)">â¬…
                        <span data-i18n="previous">Anterior</span></button>
                    <span id="bridgePageIndicator" style="font-size:13px; color:#6B7280; margin:0 10px;"
                        data-i18n="page_x_of_y">PÃ¡gina
                        1</span>
                    <button id="btnBridgeNext" class="btn-holders" onclick="changeBridgePage(1)"><span
                            data-i18n="next">Siguiente</span>
                        âž¡</button>
                    <button id="btnBridgeLast" class="btn-holders" onclick="changeBridgePage('last')"
                        title="Final">â‡¥</button>
                </div>
            </div>
        </div>

        <div id="balance" class="tab-content active">
            <h2 style="color:#6B7280; font-size:14px; margin-bottom:5px;" data-i18n="total_net_worth">
                Patrimonio Total
            </h2>
            <div class="total-balance" id="totalNetWorth">$0.00</div>

            <div style="margin-top:20px;">
                <div class="card" style="margin-bottom: 25px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                        <h3 style="margin:0; font-size:18px;" data-i18n="header_my_wallets">ðŸ’¼ Mis
                            Wallets</h3>
                        <div style="display:flex; gap:10px; align-items: center;">
                            <label class="toggle-switch"
                                style="display:flex; align-items:center; gap:8px; cursor:pointer;"
                                title="Agrupar todas las wallets">
                                <span
                                    style="font-size:13px; color:var(--text-secondary); font-weight:500;">Agrupar</span>
                                <div style="position:relative; width:36px; height:20px; background:#E5E7EB; border-radius:20px; transition:0.3s;"
                                    id="groupWalletsTrack">
                                    <div style="position:absolute; top:2px; left:2px; width:16px; height:16px; background:white; border-radius:50%; transition:0.3s; box-shadow:0 1px 3px rgba(0,0,0,0.2);"
                                        id="groupWalletsKnob"></div>
                                </div>
                                <input type="checkbox" id="groupWalletsCheckbox" onchange="toggleGroupWallets()"
                                    style="display:none;">
                            </label>
                            <button class="btn-primary" onclick="openAddWalletModal()" data-i18n="btn_add_wallet">+
                                AÃ±adir Wallet</button>
                        </div>
                    </div>
                    <div class="wallet-list" id="myWalletsList"></div>
                </div>

                <div class="card">
                    <h3 style="margin-bottom:20px; font-size:18px;" data-i18n="header_watch_wallets">ðŸ‘€
                        Wallets
                        Vigiladas</h3>
                    <div class="wallet-list" id="watchWalletsList"></div>
                </div>
            </div>
        </div>

        <div id="liquidity" class="tab-content">
            <div class="card">
                <h3 data-i18n="liquidity_pools" style="margin-bottom: 20px; display: block;">ðŸŒŠ Liquidez
                    (Pools)</h3>

                <div style="display:flex; gap:25px; margin-bottom:15px; flex-wrap:wrap; align-items: center;">
                    <button id="btnPoolAll" class="filter-btn active" onclick="setPoolFilter('all')" data-i18n="all"
                        style="padding: 0 20px; height: 40px; border-radius: 20px;">Todo</button>

                    <button id="btnPoolXor" class="filter-btn" onclick="setPoolFilter('XOR')" title="XOR (DEX 0)"
                        style="padding:0; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; overflow:hidden;">
                        <img src="https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x0200000000000000000000000000000000000000000000000000000000000000.svg"
                            style="width:100%; height:100%; object-fit:cover;"
                            onerror="this.onerror=null;this.src='https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x0200000000000000000000000000000000000000000000000000000000000000.svg'">
                    </button>

                    <button id="btnPoolXst" class="filter-btn" onclick="setPoolFilter('XSTUSD')" title="XST (DEX 1)"
                        style="padding:0; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; overflow:hidden;">
                        <img src="https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x0200080000000000000000000000000000000000000000000000000000000000.svg"
                            style="width:100%; height:100%; object-fit:cover;"
                            onerror="this.onerror=null;this.src='https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x0200080000000000000000000000000000000000000000000000000000000000.svg'">
                    </button>

                    <button id="btnPoolKusd" class="filter-btn" onclick="setPoolFilter('KUSD')" title="KUSD (DEX 2)"
                        style="padding:0; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; overflow:hidden;">
                        <img src="https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x008007725905d45d6560965d0828782a202df672153503e7c81525b6a71d7c49.svg"
                            style="width:100%; height:100%; object-fit:cover;"
                            onerror="this.onerror=null;this.src='https://raw.githubusercontent.com/sora-xor/polkaswap-token-whitelist/master/assets/0x008007725905d45d6560965d0828782a202df672153503e7c81525b6a71d7c49.svg'">
                    </button>
                </div>

                <div class="search-box">
                    <span style="padding:8px; color:#6B7280; font-size:14px;" data-i18n="total_pools">Total Pools: <b
                            id="poolTotalBadge">-</b></span>
                    <div style="flex:1;"></div>
                    <button class="btn-holders" id="btnPoolPrev" onclick="changePoolPage(-1)" disabled>â—€</button>
                    <span id="poolPageIndicator"
                        style="font-size:12px; align-self:center; margin:0 10px; color:#6B7280;"></span>
                    <button class="btn-holders" id="btnPoolNext" onclick="changePoolPage(1)" disabled>â–¶</button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th data-i18n="pair">Par</th>
                            <th data-i18n="reserves">Reservas</th>
                            <th data-i18n="providers">Providers</th>
                            <th style="text-align:right;" data-i18n="activity">Activity</th>
                        </tr>
                    </thead>
                    <tbody id="poolTable">
                        <tr>
                            <td colspan="3" style="text-align:center; padding:20px;" data-i18n="loading_pools">Cargando
                                pools...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Global Liquidity Activity -->
            <div class="card" style="margin-top: 20px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 data-i18n="activity" style="margin:0; font-size:18px;">Actividad</h3>
                    <input type="datetime-local" id="liquidityDateInput" onchange="loadGlobalLiquidity(true)"
                        style="padding:6px; border:1px solid #E5E7EB; border-radius:8px; color:#374151; font-family:inherit; font-size:13px; max-width:180px;">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="time">Hora</th>
                            <th data-i18n="block">Bloque</th>
                            <th data-i18n="pair">Par</th>
                            <th data-i18n="type">Tipo</th>
                            <th data-i18n="amount">Cantidad</th>
                            <th data-i18n="wallet">Wallet</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="liquidityTable">
                        <tr>
                            <td colspan="7" style="text-align:center; padding:20px; color:#9CA3AF;"
                                data-i18n="waiting_activity">Esperando actividad...</td>
                        </tr>
                    </tbody>
                </table>
                <div style="display:flex; justify-content:center; gap:5px; margin-top:20px; align-items:center;">
                    <button id="btnLiqFirst" class="btn-holders" onclick="changeLiquidityPage('first')"
                        title="Inicio">â‡¤</button>
                    <button id="btnLiqPrev" class="btn-holders" onclick="changeLiquidityPage(-1)">â¬… <span
                            data-i18n="previous">Anterior</span></button>
                    <span id="liquidityPageIndicator" style="font-size:13px; color:#6B7280; margin:0 10px;"
                        data-i18n="page_x_of_y">PÃ¡gina 1</span>
                    <button id="btnLiqNext" class="btn-holders" onclick="changeLiquidityPage(1)"><span
                            data-i18n="next">Siguiente</span> âž¡</button>
                    <button id="btnLiqLast" class="btn-holders" onclick="changeLiquidityPage('last')"
                        title="Final">â‡¥</button>
                </div>
            </div>
        </div>

        <div id="swaps" class="tab-content">
            <div class="card">
                <div
                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; flex-wrap:wrap; gap:10px;">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <h3 style="margin:0;" data-i18n="live_swaps">âš¡ En Vivo</h3>
                        <input type="datetime-local" id="swapDateInput" onchange="loadGlobalSwaps(true)"
                            style="padding:6px; border:1px solid #E5E7EB; border-radius:8px; color:#374151; font-family:inherit; font-size:13px;">
                    </div>
                    <div class="custom-dropdown" id="swapTokenDropdown">
                        <div class="dropdown-btn" onclick="toggleSwapDropdown()" id="swapDropdownBtn">
                            <span data-i18n="all_tokens">Todos los Tokens</span>
                            <span style="font-size:10px;">â–¼</span>
                        </div>
                        <div class="dropdown-content" id="swapDropdownContent">
                            <input type="text" class="dropdown-search" id="swapDropdownSearch"
                                placeholder="Buscar token..." onkeyup="filterDropdownList()"
                                data-i18n-placeholder="search_token">
                            <div class="dropdown-list" id="swapTokenList">
                            </div>
                        </div>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="time">Hora</th>
                            <th data-i18n="block">Bloque</th>
                            <th data-i18n="input">Entrada</th>
                            <th></th>
                            <th data-i18n="output">Salida</th>
                            <th data-i18n="account">Cuenta</th>
                            <th data-i18n="action">AcciÃ³n</th>
                        </tr>
                    </thead>
                    <tbody id="swapTable"></tbody>
                </table>
                <div style="display:flex; justify-content:center; gap:5px; margin-top:20px; align-items:center;">
                    <button id="btnSwapFirst" class="btn-holders" onclick="changeSwapPage('first')"
                        title="Inicio">â‡¤</button>
                    <button id="btnSwapPrev" class="btn-holders" onclick="changeSwapPage(-1)">â¬… <span
                            data-i18n="previous">Anterior</span></button>
                    <span id="swapPageIndicator" style="font-size:13px; color:#6B7280; margin:0 10px;"
                        data-i18n="page_x_of_y">PÃ¡gina
                        1</span>
                    <button id="btnSwapNext" class="btn-holders" onclick="changeSwapPage(1)"><span
                            data-i18n="next">Siguiente</span> âž¡</button>
                    <button id="btnSwapLast" class="btn-holders" onclick="changeSwapPage('last')"
                        title="Final">â‡¥</button>
                </div>
            </div>
        </div>

        <div id="tokens" class="tab-content">
            <div class="card" style="padding: 12px 20px; margin-bottom: 20px;">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">

                    <!-- Left Group: Refresh & Tabs -->
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <button class="btn-red" onclick="loadTokens()" data-i18n="refresh"
                            style="padding: 6px 12px; font-size: 13px; display: flex; align-items: center; gap: 5px;">
                            <span>Actualizar</span>
                        </button>

                        <div style="height: 24px; width: 1px; background: #E5E7EB;"></div>
                        <!-- Separator -->

                        <div style="display: flex; gap: 5px; background: #F3F4F6; padding: 4px; border-radius: 8px;">
                            <button id="btnTabAll" class="tab-btn-small active" onclick="setTokenTab('all')"
                                data-i18n="all"
                                style="border:none; border-radius: 6px; padding: 4px 12px; font-size: 13px; cursor: pointer;">Todos</button>
                            <button id="btnTabFav" class="tab-btn-small" onclick="setTokenTab('fav')"
                                data-i18n="favorites"
                                style="border:none; border-radius: 6px; padding: 4px 12px; font-size: 13px; cursor: pointer;">â­
                                Favoritos</button>
                        </div>
                    </div>

                    <!-- Right Group: Search -->

                    <!-- MODAL AGREGAR WALLET -->
                    <div style="flex: 1; max-width: 300px;">
                        <input type="text" id="tokenSearch" placeholder="Buscar..." onkeyup="filterTokens()"
                            data-i18n-placeholder="search_token"
                            style="width: 100%; padding: 8px 12px; border: 1px solid #E5E7EB; border-radius: 8px; font-size: 13px; outline: none; transition: border-color 0.2s;"
                            onfocus="this.style.borderColor='#D0021B'" onblur="this.style.borderColor='#E5E7EB'">
                    </div>

                </div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th style="width: 30px;"></th>
                        <th style="width: 200px;" data-i18n="asset">Activo</th>
                        <th style="width: 150px;" data-i18n="price">Precio</th>
                        <th style="width: 100px;">
                            <select id="tfSelect" onchange="changeTimeframe(this.value)"
                                style="border:none; background:transparent; font-weight:bold; color:#6B7280; font-size:12px; cursor:pointer; outline:none;">
                                <option value="1h">1h %</option>
                                <option value="4h">4h %</option>
                                <option value="24h" selected>24h %</option>
                                <option value="7d">7d %</option>
                            </select>
                        </th>
                        <!-- Sparkline Header REMOVED -->
                        <th style="width: 120px; text-align:center;">Holders</th>
                        <th style="width: 120px; text-align:center;">GrÃ¡fico</th>
                    </tr>
                </thead>
                <tbody id="tokenTable">
                    <tr>
                        <td colspan="4" style="text-align:center;" data-i18n="loading">Cargando...</td>
                    </tr>
                </tbody>
            </table>
            <div style="display:flex; justify-content:space-between; margin-top:20px; align-items:center;">
                <button id="btnTokenPrev" class="btn-holders" onclick="changeTokenPage(-1)">â¬… <span
                        data-i18n="previous">Anterior</span></button>
                <span id="tokenPageIndicator" style="font-size:13px; color:#6B7280;" data-i18n="page_x_of_y">PÃ¡gina
                    1</span>
                <button id="btnTokenNext" class="btn-holders" onclick="changeTokenPage(1)"><span
                        data-i18n="next">Siguiente</span> âž¡</button>
            </div>
        </div>




        <!-- SECTION: SORA INTELLIGENCE -->
        <div id="section-intelligence" class="tab-content" style="display:none; animation: fadeIn 0.3s;">

            <div class="sticky-header">
                <!-- Global Timeframe Selector -->

                <!-- Token Selector for Accumulation (Moved here for global context or keep local? Let's keep local but sync timeframe) -->

                <div style="display:flex; align-items:center; gap:12px;">
                    <span style="font-size:13px; color:var(--text-secondary); font-weight:500; white-space:nowrap;"
                        data-i18n="timeframe">
                        Timeframe:
                    </span>

                    <!-- Custom Dropdown HTML -->
                    <div class="custom-select-wrapper" id="global-tf-wrapper">
                        <div class="custom-select-trigger" onclick="toggleGlobalDropdown(event)">
                            <span id="global-tf-display">1D</span>
                        </div>
                        <div class="custom-options">
                            <span class="custom-option" onclick="selectGlobalTimeframe('1h', '1H')">1H</span>
                            <span class="custom-option" onclick="selectGlobalTimeframe('4h', '4H')">4H</span>
                            <span class="custom-option selected" onclick="selectGlobalTimeframe('1d', '1D')">1D</span>
                            <span class="custom-option" onclick="selectGlobalTimeframe('7d', '7D')">7D</span>
                            <span class="custom-option" onclick="selectGlobalTimeframe('30d', '30D')">30D</span>
                            <span class="custom-option" onclick="selectGlobalTimeframe('1y', '1Y')">1Y</span>
                            <span class="custom-option" onclick="selectGlobalTimeframe('all', 'ALL')"
                                data-i18n="all">ALL</span>
                        </div>
                    </div>
                    <!-- Hidden Input for compatibility -->
                    <input type="hidden" id="header-timeframe" value="1d">
                </div>
            </div>

            <!-- HEADER STATS (Now below sticky header) -->
            <div class="header-stats"
                style="display:grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap:15px; margin-bottom:25px;">
                <div class="intel-card" style="padding:15px; text-align:center; box-shadow:0 1px 3px rgba(0,0,0,0.1);">
                    <div style="font-size:11px; text-transform:uppercase; color:#6B7280; margin-bottom:5px; font-weight:600;"
                        data-i18n="current_block">
                        Current Block</div>
                    <div class="stat-big" id="stat-block">-</div>
                    <div class="stat-sub" style="font-weight:normal; color:#9CA3AF;" data-i18n="live">Live</div>
                </div>
                <!-- Extrinsics Removed -->
                <div class="intel-card" style="padding:15px; text-align:center; box-shadow:0 1px 3px rgba(0,0,0,0.1);">
                    <div style="font-size:11px; text-transform:uppercase; color:#6B7280; margin-bottom:5px; font-weight:600;"
                        data-i18n="swaps">
                        Swaps</div>
                    <div class="stat-big" id="stat-swaps">-</div>
                    <div class="stat-sub" style="color:#10B981;" id="lbl-swaps" data-i18n="time_filtered">Filtered</div>
                </div>
                <div class="intel-card" style="padding:15px; text-align:center; box-shadow:0 1px 3px rgba(0,0,0,0.1);">
                    <div style="font-size:11px; text-transform:uppercase; color:#6B7280; margin-bottom:5px; font-weight:600;"
                        data-i18n="transfers">
                        Transfers</div>
                    <div class="stat-big" id="stat-transfers">-</div>
                    <div class="stat-sub" style="color:#10B981;" id="lbl-transfers" data-i18n="time_filtered">Filtered
                    </div>
                </div>
                <div class="intel-card" style="padding:15px; text-align:center; box-shadow:0 1px 3px rgba(0,0,0,0.1);">
                    <div style="font-size:11px; text-transform:uppercase; color:#6B7280; margin-bottom:5px; font-weight:600;"
                        data-i18n="bridges">
                        Bridges</div>
                    <div class="stat-big" id="stat-bridges">-</div>
                    <div class="stat-sub" style="font-weight:normal; color:#9CA3AF;" id="lbl-bridges"
                        data-i18n="time_filtered">Filtered</div>
                </div>
            </div>

            <!-- NETWORK FEES MOVED HERE -->
            <div class="intel-card" style="margin-bottom:20px;">
                <div class="intel-title" data-i18n="network_fees">ðŸ’¸ Network Fees Paid</div>
                <div id="intel-fees-list"
                    style="display:flex; justify-content:space-around; flex-wrap:wrap; gap:20px; padding:10px 0;">
                    <div style="text-align:center; flex:1;">
                        <div style="font-size:11px; color:#6B7280; text-transform:uppercase; font-weight:600;"
                            data-i18n="swaps">Swaps
                        </div>
                        <div id="fee-swap-xor" style="font-size:16px; font-weight:600; color:#374151;">0 XOR</div>
                        <div id="fee-swap-usd" style="font-size:12px; color:#10B981;">$0.00</div>
                    </div>
                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="font-size:11px; color:#6B7280; text-transform:uppercase; font-weight:600;"
                            data-i18n="transfers">Transfers
                        </div>
                        <div id="fee-transfer-xor" style="font-size:16px; font-weight:600; color:#374151;">0 XOR</div>
                        <div id="fee-transfer-usd" style="font-size:12px; color:#10B981;">$0.00</div>
                    </div>
                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="font-size:11px; color:#6B7280; text-transform:uppercase; font-weight:600;"
                            data-i18n="bridges">Bridges
                        </div>
                        <div id="fee-bridge-xor" style="font-size:16px; font-weight:600; color:#374151;">0 XOR</div>
                        <div id="fee-bridge-usd" style="font-size:12px; color:#10B981;">$0.00</div>
                    </div>
                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="font-size:11px; color:#6B7280; text-transform:uppercase; font-weight:600;"
                            data-i18n="other">Others
                        </div>
                        <div id="fee-other-xor" style="font-size:16px; font-weight:600; color:#374151;">0 XOR</div>
                        <div id="fee-other-usd" style="font-size:12px; color:#10B981;">$0.00</div>
                    </div>
                    <div
                        style="text-align:center; flex:1; border-left:1px solid var(--border-color); background:var(--bg-body); border-radius:8px; padding:5px;">
                        <div style="font-size:11px; color:#6B7280; text-transform:uppercase; font-weight:bold;">Total
                        </div>
                        <div id="fee-total-xor" style="font-size:18px; font-weight:bold; color:#D0021B;">0 XOR</div>
                        <div id="fee-total-usd" style="font-size:13px; color:#6B7280;">$0.00</div>
                    </div>
                </div>

                <!-- CHARTS -->
                <div
                    style="display:flex; flex-wrap:wrap; gap:20px; margin-top:15px; border-top:1px solid var(--border-color); padding-top:15px;">
                    <div style="flex:1; min-width:300px; height:220px; position:relative;">
                        <canvas id="feesDonutChart"></canvas>
                    </div>
                    <div style="flex:2; min-width:300px; height:220px; position:relative;">
                        <canvas id="feesLineChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- NETWORK INFO (Moved to Full Width) -->
            <div class="intel-card" style="margin-bottom:20px;">
                <div class="intel-title" data-i18n="network_info">ðŸ“Š Network Info</div>

                <div id="intel-network-list"
                    style="display:flex; justify-content:space-around; flex-wrap:wrap; gap:20px; padding:10px 0;">
                    <div style="text-align:center; flex:1;">
                        <div style="color:#6B7280; font-size:12px; text-transform:uppercase; font-weight:600;"
                            data-i18n="active_accounts">Active Accounts</div>
                        <div class="stat-big" id="intel-accounts" style="color:#3B82F6;">0</div>
                    </div>

                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="color:#6B7280; font-size:12px; text-transform:uppercase; font-weight:600;"
                            data-i18n="swap_volume">Swap Volume (KUSD)</div>
                        <div class="stat-big" id="intel-swap-vol" style="color:#8B5CF6;">$0.00</div>
                    </div>

                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="color:#6B7280; font-size:12px; text-transform:uppercase; font-weight:600;"
                            data-i18n="lp_volume">New LP Volume</div>
                        <div class="stat-big" id="intel-lp-vol" style="color:#F59E0B;">$0.00</div>
                    </div>

                    <div style="text-align:center; flex:1; border-left:1px solid var(--border-color);">
                        <div style="color:#6B7280; font-size:12px; text-transform:uppercase; font-weight:600;"
                            data-i18n="transfer_volume">Transfer Volume</div>
                        <div class="stat-big" id="intel-transfer-vol" style="color:#10B981;">$0.00</div>
                    </div>
                </div>

                <!-- NEW CHART -->
                <div
                    style="height:250px; position:relative; margin-top:15px; border-top:1px solid var(--border-color); padding-top:15px;">
                    <canvas id="networkLineChart"></canvas>
                </div>
            </div>

            <!-- STABLECOIN MONITOR (Full Width) -->
            <div class="intel-card" style="margin-bottom:20px;">
                <div class="intel-title" data-i18n="stablecoin_monitor">âš–ï¸ Stablecoin Monitor</div>
                <div id="intel-pegs" style="display:flex; flex-direction:column; gap:20px;">
                    <!-- List (Horizontal Row) -->
                    <div id="stablecoin-list"
                        style="display:flex; flex-wrap:wrap; gap:15px; justify-content:space-between;">
                        <!-- Populated by JS -->
                        <span style="color:#999; font-size:12px; width:100%; text-align:center;">Cargando
                            stablecoins...</span>
                    </div>
                    <!-- Peg Chart -->
                    <div
                        style="height:320px; width:100%; position:relative; border-top:1px solid var(--border-color); padding-top:15px;">
                        <canvas id="pegChart"></canvas>
                    </div>
                </div>
                <div style="font-size:10px; color:#999; margin-top:10px; text-align:right;">* Deviation > 1.00 = Premium
                    | < 1.00=Discount</div>
                </div>

                <div class="intel-grid">
                    <!-- WALLET RANKING -->
                    <div class="intel-card" style="grid-column: span 2;">
                        <div class="intel-title">
                            <span data-i18n="whale_leaderboard">ðŸ³ Whale Accumulation Leaderboard</span>
                            <div style="display:flex; gap:10px; align-items:center;">
                                <!-- Custom Token Selector -->
                                <div class="custom-select-wrapper" id="acc-token-wrapper" style="width:100px;">
                                    <div class="custom-select-trigger" onclick="toggleAccDropdown(event)">
                                        <span id="acc-token-display">XOR</span>
                                    </div>
                                    <div class="custom-options">
                                        <span class="custom-option selected"
                                            onclick="selectAccToken('XOR', 'XOR')">XOR</span>
                                        <span class="custom-option" onclick="selectAccToken('VAL', 'VAL')">VAL</span>
                                        <span class="custom-option"
                                            onclick="selectAccToken('PSWAP', 'PSWAP')">PSWAP</span>
                                        <span class="custom-option" onclick="selectAccToken('TBCD', 'TBCD')">TBCD</span>
                                        <span class="custom-option"
                                            onclick="selectAccToken('XSTUSD', 'XSTUSD')">XSTUSD</span>
                                        <span class="custom-option" onclick="selectAccToken('KEN', 'KEN')">KEN</span>
                                    </div>
                                </div>
                                <input type="hidden" id="intel-acc-token" value="XOR">
                            </div>
                        </div>

                        <div id="intel-acc-list">
                            <div style="text-align:center; color:#999; padding:20px;" data-i18n="loading_whales">
                                Cargando
                                Whales...</div>
                        </div>
                    </div>

                    <!-- NETWORK INFO (formerly Network Health) -->


                    <!-- TRENDS -->
                    <div class="intel-card">
                        <div class="intel-title" data-i18n="trending_tokens">ðŸ“ˆ Trending Tokens</div>
                        <div id="intel-trends"
                            style="display:flex; flex-wrap:wrap; gap:20px; align-items:center; width:100%;">
                            <!-- Chart -->
                            <div style="flex:1; min-width:300px; height:250px; position:relative;">
                                <canvas id="trendingDonutChart"></canvas>
                            </div>
                            <!-- Legend -->
                            <div id="trending-legend"
                                style="flex:1; min-width:200px; display:flex; flex-direction:column; gap:10px;">
                                <!-- Populated by JS -->
                                <span style="color:#999; font-size:12px; text-align:center;">Cargando...</span>
                            </div>
                        </div>
                    </div>
                    <!-- NETWORK FEES -->

                </div>
            </div>

            <div id="holderModal" class="modal">
                <div class="modal-content">
                    <span class="close-modal" onclick="closeModal()">&times;</span>
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                        <h2 id="modalTitle" style="margin:0;" data-i18n="holders">Holders</h2>
                        <span id="totalHoldersBadge"
                            style="background:#EEF2FF; padding:4px 10px; border-radius:12px; font-size:12px;">0
                            cuentas</span>
                    </div>
                    <div
                        style="height: 400px; overflow-y: auto; border: 1px solid #E5E7EB; border-radius: 12px; padding:0 10px;">
                        <table style="font-size: 14px;">
                            <thead style="position: sticky; top: 0; background: white;">
                                <tr>
                                    <th data-i18n="rank">Rank</th>
                                    <th data-i18n="wallet">Wallet</th>
                                    <th style="text-align:right;" data-i18n="balance">Saldo</th>
                                </tr>
                            </thead>
                            <tbody id="holdersTableBody"></tbody>
                        </table>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-top:20px;">
                        <button id="btnPrev" class="btn-holders" onclick="changePage(-1)">â¬… <span
                                data-i18n="previous">Anterior</span></button>
                        <span id="pageIndicator" style="font-size:13px; color:#6B7280;" data-i18n="page_x_of_y">PÃ¡gina
                            1</span>
                        <button id="btnNext" class="btn-holders" onclick="changePage(1)"><span
                                data-i18n="next">Siguiente</span>
                            âž¡</button>
                    </div>
                </div>
            </div>

            <div id="addWalletModal" class="modal">
                <div class="modal-content" style="max-width: 400px;">
                    <span class="close-modal" onclick="closeAddWalletModal()">&times;</span>
                    <h2 style="margin-top:0;" data-i18n="add_wallet">AÃ±adir Wallet</h2>

                    <!-- Toggle Modes -->
                    <div
                        style="display:flex; gap:10px; margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;">
                        <button id="mode-single" class="tab-btn-small active"
                            onclick="switchAddWalletMode('single')">Single</button>
                        <button id="mode-bulk" class="tab-btn-small" onclick="switchAddWalletMode('bulk')">Bulk
                            (.txt)</button>
                    </div>

                    <!-- Single Mode -->
                    <div id="add-wallet-single">
                        <div style="margin-bottom:15px;">
                            <label style="display:block; margin-bottom:5px; font-weight:bold;"
                                data-i18n="sora_address">DirecciÃ³n
                                SORA</label>
                            <input type="text" id="newWalletAddr" placeholder="cn..." style="width:100%;">
                        </div>
                        <div style="margin-bottom:15px;">
                            <label style="display:block; margin-bottom:5px; font-weight:bold;"
                                data-i18n="name_alias">Nombre
                                (Alias)</label>
                            <input type="text" id="newWalletName" placeholder="Ej: Ahorros" style="width:100%;"
                                data-i18n-placeholder="example_savings">
                        </div>
                    </div>

                    <!-- Bulk Mode -->
                    <div id="add-wallet-bulk" style="display:none;">
                        <div style="margin-bottom:15px;">
                            <label style="display:block; margin-bottom:5px; font-weight:bold;">Upload .txt
                                File</label>
                            <input type="file" id="bulkWalletFile" accept=".txt" style="width:100%;">
                            <p style="font-size:12px; color:#6B7280; margin-top:5px;">
                                Format: One address per line.<br>
                                Optional: `address,alias`
                            </p>
                        </div>
                    </div>

                    <div style="margin-bottom:20px;">
                        <label style="display:block; margin-bottom:5px; font-weight:bold;" data-i18n="type">Tipo</label>
                        <select id="newWalletType"
                            style="width:100%; padding:8px; border-radius:8px; border:1px solid #ddd;">
                            <option value="my" data-i18n="my_wallet_total">Mi Billetera (Suman al total)
                            </option>
                            <option value="watch" data-i18n="watched_wallet_tracking">Observada (Seguimiento)
                            </option>
                        </select>
                    </div>

                    <button class="btn-red" style="width:100%;" onclick="submitAddWallet()"
                        data-i18n="save_wallet">Guardar
                        Wallet</button>
                </div>
            </div>

            <div id="chartModal" class="modal">
                <div class="modal-content" style="width: 800px; max-width: 95%;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <h2 id="chartTitle" style="margin:0;">GrÃ¡fico</h2>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <!-- Indicators Menu -->
                            <div class="dropdown" style="position:relative; display:inline-block;">
                                <button class="time-btn" onclick="toggleIndicatorsMenu()"
                                    style="display:flex; align-items:center; gap:5px;">
                                    <span>Æ’x</span> <span style="font-size:10px;">â–¼</span>
                                </button>
                                <div id="indicatorsMenu" class="dropdown-content"
                                    style="display:none; position:absolute; right:0; background:var(--bg-secondary); border:1px solid var(--border-color); border-radius:8px; padding:10px; min-width:150px; z-index:1000; box-shadow:0 10px 15px -3px rgba(0,0,0,0.1);">
                                    <div style="font-size:12px; color:var(--text-secondary); margin-bottom:5px;">
                                        Overlays</div>
                                    <label
                                        style="display:flex; align-items:center; gap:8px; padding:5px; cursor:pointer;"
                                        onclick="toggleIndicator('SMA')">
                                        <input type="checkbox" id="chkSMA"> <span
                                            style="color:#2962FF; font-weight:bold;">SMA 20</span>
                                    </label>
                                    <label
                                        style="display:flex; align-items:center; gap:8px; padding:5px; cursor:pointer;"
                                        onclick="toggleIndicator('EMA')">
                                        <input type="checkbox" id="chkEMA"> <span
                                            style="color:#E91E63; font-weight:bold;">EMA 20</span>
                                    </label>
                                </div>
                            </div>

                            <button class="time-btn" onclick="updateChartTimeframe(5)">5m</button>
                            <button class="time-btn" onclick="updateChartTimeframe(15)">15m</button>
                            <button class="time-btn active" onclick="updateChartTimeframe(60)">1H</button>
                            <button class="time-btn" onclick="updateChartTimeframe(240)">4H</button>
                            <button class="time-btn" onclick="updateChartTimeframe(1440)">1D</button>

                            <!-- Fullscreen Toggle -->
                            <button class="time-btn" onclick="toggleChartFullscreen()" title="Pantalla Completa"
                                style="margin-left:5px;">
                                â›¶
                            </button>
                        </div>
                        <span class="close-modal"
                            onclick="document.getElementById('chartModal').style.display='none'">&times;</span>
                    </div>
                    <div id="chartContainer" style="width: 100%; height: 400px;"></div>
                </div>
            </div>

            <div id="poolDetailsModal" class="modal">
                <div class="modal-content" style="max-width: 800px; height: 80vh; display:flex; flex-direction:column;">
                    <div
                        style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; position:relative; padding-right:40px;">
                        <div>
                            <h2 id="poolDetailsTitle" style="margin:0;">Pool Details</h2>
                            <span id="poolDetailsSub"
                                style="font-family:monospace; color:var(--text-secondary); font-size:12px;"></span>
                        </div>
                        <span class="close-modal" onclick="closePoolDetailsModal()"
                            style="position:absolute; right:0; top:0; font-size:40px; line-height:0.8;">&times;</span>
                    </div>

                    <div id="poolDetailsTabs" class="tabs modal-tabs"
                        style="justify-content:flex-start; margin-bottom:15px; border-bottom:1px solid #eee;">
                        <button id="ptab-providers" class="tab-btn active"
                            onclick="openPoolTab('providers')">Providers</button>
                        <button id="ptab-activity" class="tab-btn" onclick="openPoolTab('activity')">Activity</button>
                    </div>

                    <div id="pview-providers" class="wtab-content active" style="flex:1; overflow-y:auto;">
                        <table style="width:100%;">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Wallet</th>
                                    <th>Liquidity Shares</th>
                                </tr>
                            </thead>
                            <tbody id="poolProvidersTable"></tbody>
                        </table>
                    </div>

                    <div id="pview-activity" class="wtab-content" style="flex:1; overflow-y:auto; display:none;">
                        <table style="width:100%;">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Wallet</th>
                                    <th style="text-align:right;">Amount</th>
                                </tr>
                            </thead>
                            <tbody id="poolActivityTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="walletDetailsModal" class="modal">
                <div class="modal-content" style="max-width: 800px; height: 80vh; display:flex; flex-direction:column;">
                    <div
                        style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; position:relative; padding-right:40px;">
                        <div>
                            <h2 id="detailsTitle" style="margin:0;" data-i18n="wallet">Wallet</h2>
                            <span id="detailsAddr"
                                style="font-family:monospace; color:#6B7280; font-size:12px; word-break:break-all;"></span>
                        </div>
                        <span class="close-modal" onclick="closeDetailsModal()"
                            style="position:absolute; right:0; top:0; font-size:40px; line-height:0.8;">&times;</span>
                    </div>

                    <div class="tabs modal-tabs"
                        style="justify-content:flex-start; margin-bottom:15px; border-bottom:1px solid #eee;">
                        <button id="wtab-assets" class="tab-btn active" style="font-size:14px; padding:5px 15px;"
                            onclick="openWTab('assets')" data-i18n="assets">Activos</button>
                        <button id="wtab-swaps" class="tab-btn" style="font-size:14px; padding:5px 15px;"
                            onclick="openWTab('swaps')" data-i18n="swaps">Swaps</button>
                        <button id="wtab-transfers" class="tab-btn" style="font-size:14px; padding:5px 15px;"
                            onclick="openWTab('transfers')" data-i18n="transfers">Transferencias</button>
                        <button id="wtab-bridges" class="tab-btn" style="font-size:14px; padding:5px 15px;"
                            onclick="openWTab('bridges')" data-i18n="bridges">Puentes</button>
                        <button id="wtab-liquidity" class="tab-btn" style="font-size:14px; padding:5px 15px;"
                            onclick="openWTab('liquidity')" data-i18n="liquidity">Liquidez</button>
                    </div>

                    <div id="wview-assets" class="wtab-content active" style="flex:1; overflow-y:auto;">
                        <div id="wAssetsList" class="tokens-grid"></div>
                    </div>

                    <div id="wview-swaps" class="wtab-content" style="flex:1; overflow-y:auto; display:none;">
                        <table style="width:100%;">
                            <thead>
                                <tr>
                                    <th data-i18n="time">Hora</th>
                                    <th data-i18n="input">Entrada</th>
                                    <th data-i18n="output">Salida</th>
                                </tr>
                            </thead>
                            <tbody id="wSwapsTable"></tbody>
                        </table>
                        <div class="pagination-controls"
                            style="margin-top:10px; display:flex; gap:10px; align-items:center; justify-content:center;">
                            <button class="secondary-btn" id="btnWSwapPrev"
                                onclick="changeWSwapPage(-1)">Previous</button>
                            <span id="wSwapPageIndicator" style="font-size:12px; color:#6B7280;">Page 1</span>
                            <button class="top-btn" id="btnWSwapNext" onclick="changeWSwapPage(1)">Next</button>
                        </div>
                    </div>

                    <div id="wview-transfers" class="wtab-content" style="flex:1; overflow-y:auto; display:none;">
                        <table style="width:100%;">
                            <thead>
                                <tr>
                                    <th data-i18n="time">Hora</th>
                                    <th data-i18n="type">Tipo</th>
                                    <th data-i18n="other">Otro</th>
                                    <th data-i18n="amount">Cantidad</th>
                                </tr>
                            </thead>
                            <tbody id="wTransfersTable"></tbody>
                        </table>
                        <div class="pagination-controls"
                            style="margin-top:10px; display:flex; gap:10px; align-items:center; justify-content:center;">
                            <button class="secondary-btn" id="btnWTransferPrev"
                                onclick="changeWTransferPage(-1)">Previous</button>
                            <span id="wTransferPageIndicator" style="font-size:12px; color:#6B7280;">Page
                                1</span>
                            <button class="top-btn" id="btnWTransferNext" onclick="changeWTransferPage(1)">Next</button>
                        </div>
                    </div>

                    <div id="wview-bridges" class="wtab-content" style="flex:1; overflow-y:auto; display:none;">
                        <table style="width:100%;">
                            <thead>
                                <tr>
                                    <th data-i18n="time">Hora</th>
                                    <th data-i18n="asset">Activo</th>
                                    <th data-i18n="amount">Cantidad</th>
                                    <th data-i18n="network">Red</th>
                                </tr>
                            </thead>
                            <tbody id="wBridgesTable"></tbody>
                        </table>
                        <div class="pagination-controls"
                            style="margin-top:10px; display:flex; gap:10px; align-items:center; justify-content:center;">
                            <button class="secondary-btn" id="btnWBridgePrev"
                                onclick="changeWBridgePage(-1)">Previous</button>
                            <span id="wBridgePageIndicator" style="font-size:12px; color:var(--text-secondary);">Page
                                1</span>
                            <button class="top-btn" id="btnWBridgeNext" onclick="changeWBridgePage(1)">Next</button>
                        </div>
                    </div>

                    <div id="wview-liquidity" class="wtab-content" style="flex:1; overflow-y:auto; display:none;">
                        <div id="wLiquidityList" style="display:grid; gap:10px; padding:10px;"></div>
                    </div>
                </div>
            </div>

            <!-- Block Details Modal -->
            <div id="blockModal" class="modal">
                <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <span class="close-modal"
                        onclick="document.getElementById('blockModal').style.display='none'">&times;</span>
                    <h2 style="margin-top:0;">Block Details #<span id="blockModalNumber"></span></h2>
                    <div id="blockModalContent">Loading...</div>
                </div>
            </div>

            <!-- Transaction Details Modal -->
            <div id="txModal" class="modal">
                <div class="modal-content" style="max-width: 600px;">
                    <span class="close-modal"
                        onclick="document.getElementById('txModal').style.display='none'">&times;</span>
                    <h2 style="margin-top:0;">Transaction Details</h2>
                    <div id="txModalContent" style="word-break: break-all;">Loading...</div>
                </div>
            </div>

            <!-- MODAL BACKUP (Correct Position) -->
            <div id="backupModal" class="modal">
                <div class="modal-content" style="width: 400px;">
                    <span class="close-modal" onclick="closeBackupModal()">&times;</span>
                    <h2
                        style="margin-top:0; color:#111827; font-size:20px; display:flex; align-items:center; gap:10px;">
                        ðŸ’¾ <span data-i18n="backup_title">Copia de Seguridad</span>
                    </h2>
                    <p style="color:#6B7280; font-size:14px; margin-bottom:25px;" data-i18n="backup_desc">
                        Guarda tus billeteras y favoritos en un archivo seguro o restaura una copia anterior.
                    </p>
                    <div style="display:grid; gap:15px;">
                        <button class="btn-primary" onclick="exportBackup()"
                            style="display:flex; align-items:center; justify-content:center; gap:10px; padding:12px;">
                            â¬‡ <span data-i18n="btn_download_backup">Descargar Copia</span>
                        </button>
                        <div style="position:relative;">
                            <button class="btn-ghost" onclick="document.getElementById('importFile').click()"
                                style="width:100%; border:1px dashed #9CA3AF; padding:12px;">
                                â¬† <span data-i18n="btn_restore_backup">Restaurar Copia</span>
                            </button>
                            <input type="file" id="importFile" accept=".json" style="display:none;"
                                onchange="importBackup(this)">
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <script src="script.js?v=v4"></script>
        <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js').then(reg => {
                        console.log('SW registered:', reg);
                        reg.onupdatefound = () => {
                            const installingWorker = reg.installing;
                            installingWorker.onstatechange = () => {
                                if (installingWorker.state === 'installed') {
                                    if (navigator.serviceWorker.controller) {
                                        console.log('New content available; please refresh.');
                                    } else {
                                        console.log('Content is cached for offline use.');
                                    }
                                }
                            };
                        };
                    }).catch(err => console.log('SW registration failed:', err));

                    let refreshing;
                    navigator.serviceWorker.addEventListener('controllerchange', () => {
                        if (refreshing) return;
                        window.location.reload();
                        refreshing = true;
                    });
                });
            }
        </script>
</body>

</html>